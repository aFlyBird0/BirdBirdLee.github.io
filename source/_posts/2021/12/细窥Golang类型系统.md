---
title: ç»†çª¥Golangç±»å‹ç³»ç»Ÿ
mylink: ç»†çª¥Golangç±»å‹ç³»ç»Ÿ
date: 2021-12-20 21:09:47
tags:
	- Golang
	- å¥½æ–‡ç¿»è¯‘
categories:
---

æœ¬æ–‡æ˜¯ä¸€ç¯‡ç¿»è¯‘ï¼Œæºäºä¸å¥½å‹çš„ä¸€æ¬¡å…³äº Golang åº•å±‚ç±»å‹åˆ¤å®šçš„è®¨è®ºã€‚æ‰¾åˆ°äº†è¿™ç¯‡å¥½æ–‡ï¼Œå¥ˆä½•ä¸­æ–‡ç¿»è¯‘æ¬ ä½³ï¼ˆå†…å®¹ç¼ºã€è¯ä¸è¾¾æ„ï¼‰ï¼Œå°±çœ‹äº†åŸç‰ˆã€‚çœ‹å®Œå°±å¿ä¸ä½ç¿»è¯‘ä¸‹æ¥ï¼Œ**é€å­—æ–Ÿé…Œï¼Œå¹¶è¡¥å……äº†è®¸å¤šå†…å®¹**ï¼Œæ ‡ç¤ºã€Œè¯‘è€…æ³¨ã€ã€‚â€”â€”by çˆ±é£çš„é¸Ÿ



ä»¥ä¸‹æ­£æ–‡ï¼š



**å‰¯æ ‡é¢˜ï¼šé…åˆç¤ºä¾‹è¯¦è§£ Go è¯­è¨€ç±»å‹ç³»ç»Ÿ**



æˆ‘ä»¬å…ˆä»ä¸€ä¸ªåŸºæœ¬é—®é¢˜å¼€å§‹å§ï¼  

## ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ç±»å‹ç³»ç»Ÿï¼Ÿ

åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹å¹³æ—¥é‡Œæˆ‘ä»¬ä¸éœ€è¦æ¥è§¦çš„ç¼–ç¨‹è¯­è¨€çš„åŸå§‹è€ŒæŠ½è±¡çš„åº•å±‚å½¢æ€ã€‚  

**è®©æˆ‘ä»¬è´´è¿‘æœºå™¨æ•°çš„åº•å±‚è¡¨ç¤ºå§ï¼** 

![äºŒè¿›åˆ¶çš„0å’Œ1](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/binary0_1.jpeg)

ä¸Šé¢æ˜¯äºŒè¿›åˆ¶çš„ 0 å’Œ 1ï¼Œä¹Ÿå³æœºå™¨æ‰€èƒ½ç†è§£çš„æ•°æ®å½¢å¼ã€‚ä½†è¿™å¯¹æˆ‘ä»¬æ¥è¯´æœ‰æ„ä¹‰å—ï¼Ÿç›´åˆ°çœ‹åˆ°ä¸‹å›¾ï¼Œæˆ‘æ‰çŸ¥é“ï¼ˆæœ‰äººæ˜¯é»‘å®¢å¸å›½ç²‰å—ï¼Ÿï¼‰

![matrix](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/matrix.gif)

æˆ‘ä»¬è¿›ä¸€æ­¥æŠ½è±¡è¿™äº›äºŒè¿›åˆ¶æ•°å­—ã€‚çœ‹ä¸‹é¢è¿™æ®µæ±‡ç¼–ï¼š

![assembly](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/assembly.png)

ä½ å¯èƒ½å¸Œæœ› R1ã€R2ã€R3 æ˜¯æ•´æ•°ï¼Œå®ƒä»¬çš„ç±»å‹å…¶å®åœ¨æ±‡ç¼–è¯­è¨€å±‚é¢æ— æ³•ç¡®å®šã€‚æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢ R1ã€R2ã€R3æˆä¸ºä»»æ„ç±»å‹ï¼Œå®ƒä»¬åªæ˜¯å­˜åœ¨äºå¯„å­˜å™¨å†…éƒ¨çš„ä¸€å † 0 å’Œ 1ã€‚å³ä½¿æ²¡æœ‰æ„ä¹‰ï¼ŒåŠ æ³•è¿ç®—ä¹Ÿä¼šå°†è¿™ä¸‰ä¸ªæ•°ä»¥æŒ‰ä½ç´¯åŠ ï¼Œç„¶åå­˜å‚¨è¿ç®—ç»“æœã€‚



æ‰€ä»¥ï¼Œã€Œç±»å‹ã€çš„æ¦‚å¿µï¼Œæºäºæ›´é«˜çº§è¯­è¨€çš„æ›´æ·±å±‚æ¬¡çš„æŠ½è±¡ï¼Œä¾‹å¦‚ `C`, `Go`, `Java`, `Python` å’Œ `TypeScript`ï¼Œç±»å‹æ˜¯è¯­è¨€è‡ªèº«çš„ç‰¹æ€§ã€‚



æ‰€ä»¥æœ‰äº›è¯­è¨€å–œæ¬¢åœ¨è¿è¡Œæ—¶åšç±»å‹æ£€æŸ¥ï¼Œè€Œæœ‰äº›å–œæ¬¢åœ¨ç¼–è¯‘é˜¶æ®µåšç±»å‹æ£€æŸ¥ã€‚



> è¯‘è€…æ³¨ï¼šå³åŠ¨æ€è¯­è¨€ï¼ˆè§£é‡Šå‹ï¼‰ä¸é™æ€è¯­è¨€ï¼ˆç¼–è¯‘å‹ï¼‰çš„åŒºåˆ«ã€‚Goæ˜¯é—¨é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ï¼ŒåŒæ—¶å› ä¸º `interface` çš„å­˜åœ¨ï¼Œè®© Go å…¼å…·åŠ¨æ€æ€§çš„ä¼˜ç‚¹ã€‚

### æ‰€ä»¥ï¼Œç±»å‹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

å„ä¸ªç¼–ç¨‹è¯­è¨€ä¸­çš„ç±»å‹çš„æ¦‚å¿µä¸å°½ç›¸åŒï¼Œç±»å‹èƒ½ä»¥å¤šç§ä¸åŒçš„æ–¹å¼è¡¨è¾¾ï¼Œä½†å®ƒä»¬è¿˜æ˜¯æœ‰ä¸å°‘å…±é€šä¹‹å¤„çš„ã€‚



1. ç±»å‹æ˜¯ä¸€ç»„å€¼
2. åœ¨è¿™ç»„å€¼ä¸Šå¯ä»¥æ–½åŠ æ“ä½œã€‚å¦‚ï¼Œæ•´æ•°ç±»å‹å¯ä»¥æ–½åŠ  `+` ä¸ `-`ï¼Œå­—ç¬¦ä¸²ç±»å‹å¯ä»¥æ‹¼æ¥ã€ç©ºä¸²æ£€æŸ¥ç­‰ã€‚
3. ç±»å‹éœ€è¦åœ¨ è¿è¡Œæ—¶ `runtime` æˆ–ç¼–è¯‘æœŸ `compile` è¿›è¡Œæ£€æŸ¥ï¼Œç¡®ä¿æ•°æ®çš„æ•´ä½“æ€§ï¼Œä»¥åŠä½¿å¾—ç¼–è¯‘å™¨æŒ‰ç…§å¼€å‘è€…çš„æ„å›¾æ¥æ­£ç¡®è§£ææ•°æ®ã€‚

> è¯‘è€…æ³¨ï¼šè¿™é‡Œè§£é‡Šä¸€ä¸‹ç¬¬ä¸‰ç‚¹ã€‚æ‰€æœ‰çš„æ•°æ®ï¼Œå­˜å‚¨ä¸Šçš„è¡¨ç°éƒ½æ˜¯ï¼Œå æ®äº†ä¸€æ®µè¿ç»­å†…å­˜ç©ºé—´çš„å€¼ã€‚  
>
> 
>
> ä»¥Cè¯­è¨€å’ŒGoè¯­è¨€çš„ç»“æ„ä½“ä¸¾ä¾‹ï¼Œä»€ä¹ˆæ˜¯ã€Œæ•°æ®çš„æ•´ä½“æ€§ã€ï¼Ÿ  
>
> æˆ‘ä»¬æ¥æƒ³æƒ³ç¼–è¯‘å™¨å¦‚ä½•èƒ½ä¿è¯å–å‡ºçš„æŸä¸ªç»“æ„ä½“æ˜¯å®Œæ•´çš„ï¼Œè€Œä¸æ˜¯æ¼äº†æˆ–å¤šäº†æŸä¸ªå±æ€§å­—æ®µï¼Ÿå¾ˆç®€å•ï¼Œæ¯ä¸ªç»“æ„ä½“ç±»å‹çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œç¼–è¯‘å™¨åªè¦åœ¨å†…å­˜ä¸Šå–å‡ºè¿ç»­çš„è¯¥ç»“æ„ä½“ç±»å‹æ‰€å å­—èŠ‚æ•°çš„å†…å­˜ï¼Œå°±èƒ½ä¿è¯å–å‡ºçš„ç»“æ„ä½“æ˜¯å®Œæ•´çš„ã€‚
>
>   
>
> ä»€ä¹ˆæ˜¯ã€Œä½¿å¾—ç¼–è¯‘å™¨æŒ‰ç…§å¼€å‘è€…çš„æ„å›¾æ¥æ­£ç¡®è§£ææ•°æ®ã€ï¼Ÿ
>
> å…¶å®ä¸Šé¢çš„ä¾‹å­å·²ç»éšå«è¿™ä¸ªè§£æé—®é¢˜äº†ï¼Œæˆ‘ä»¬å†ä¸¾ä¸ªæ›´å…·ä½“çš„ä¾‹å­ã€‚  
>
> å½“å–å‡ºäº†å†…å­˜ä¸­çš„ä¸€æ®µè¿ç»­çš„å†…å­˜åï¼Œæ€ä¹ˆè§£æå‡ºå†…éƒ¨çš„ä¸€ä¸ªä¸ªå­—æ®µå±æ€§å‘¢ï¼Ÿä¹Ÿå¾ˆç®€å•ï¼ŒæŒ‰ç…§å­—æ®µçš„å®šä¹‰é¡ºåºï¼ŒæŒ‰å­—æ®µç±»å‹çš„é•¿åº¦ï¼Œä¾æ¬¡è§£æã€‚ä¾‹å¦‚ï¼Œç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯ int32 ç±»å‹ï¼Œé‚£ä¹ˆå°±å–è¿™æ®µå†…å­˜çš„å‰4ä¸ªå­—èŠ‚ï¼Œè§£ææˆç¬¬ä¸€ä¸ªå­—æ®µï¼ˆGoä¸Cçš„ç»“æ„ä½“çš„èµ·å§‹åœ°å€éƒ½ç­‰äºç¬¬ä¸€ä¸ªå­—æ®µçš„åœ°å€ï¼Œè¿™é‡Œåº”è¯¥è¿˜æœ‰å†…å­˜å¯¹é½é—®é¢˜ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯æ·±å…¥ç ”ç©¶ï¼‰



**æ‰€ä»¥ä¸€ä¸ªç¼–ç¨‹è¯­è¨€çš„ç±»å‹ç³»ç»Ÿï¼Œæ˜ç¡®äº†æŸç±»å‹ä¸‹çš„å“ªäº›æ“ä½œæ˜¯åˆæ³•çš„ã€‚**



ç±»å‹æ£€æŸ¥çš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿è¿ç®—å’Œæ“ä½œåªæ–½åŠ åœ¨æ­£ç¡®çš„ç±»å‹ä¹‹ä¸Šï¼Œå¹¶ä¸”ç¨‹åºå¿…é¡»éµå¾ªç¼–ç¨‹è¯­è¨€æ‰€å®šä¹‰çš„ç±»å‹ç³»ç»Ÿã€‚ç±»å‹æ£€æŸ¥å¯èƒ½æ˜¯åœ¨ç¼–è¯‘æœŸæ‰§è¡Œçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨ã€Œè¿è¡Œæ—¶ã€æ‰§è¡Œçš„ã€‚é€šè¿‡ç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥ä½¿å¾—æ•°æ®ä»¥æˆ‘ä»¬æœŸæœ›çš„å½¢å¼è¢«è§£é‡Šã€‚å› ä¸ºåœ¨æœºå™¨ç æ‰§è¡Œé˜¶æ®µï¼Œä¸ä¼šæœ‰ä»»ä½•æ£€æŸ¥ï¼Œå…¨æ˜¯äºŒè¿›åˆ¶çš„ 0 å’Œ 1ã€‚æœºå™¨ä¼šæ— è„‘æ‰§è¡Œæ–½åŠ åœ¨äºŒè¿›åˆ¶æ•°æ®ä¸Šçš„ä»»ä½•æ“ä½œã€‚



ç±»å‹ç³»ç»Ÿç”¨æ¥åœ¨äºŒè¿›åˆ¶å±‚é¢ï¼ˆåŸæ–‡ `bit patterns`ï¼‰å¼ºåˆ¶æ‰§è¡Œé¢„æœŸä»£ç è§£é‡Šã€‚ä¾‹å¦‚ï¼Œå®ƒä¿è¯äº†æ•´æ•°ä¸ä¼šè¢«æ–½åŠ ä»»ä½•éæ•´æ•°æ“ä½œï¼Œä»è€Œå¾—åˆ°æ— æ„ä¹‰çš„ç»“æœã€‚



ä¸€ä¸ªç±»å‹ç³»ç»Ÿç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š



1. **åŸºç¡€ç±»å‹**â€”â€”åŒ…å«åœ¨è¯¥ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¯ç”¨äºä»¥è¯¥ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ä»»ä½•ç¨‹åºã€‚Go æ‹¥æœ‰è®¸å¤šåŸºç¡€ç±»å‹ï¼Œint8 , uint8 ( byte ), int16 , uint16 , int32 ( rune ), uint32ã€‚

2. **ç±»å‹æ„é€ å™¨**â€”â€”ç¼–ç¨‹è¯­è¨€æä¾›çš„å®šä¹‰æ–°ç±»å‹çš„é€”å¾„ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ª `T` çš„æŒ‡é’ˆç±»å‹ `*T`ã€‚

   > ï¼ˆè¯‘è€…æ³¨ï¼šè®¸å¤šäººè®¤ä¸ºGoçš„æŒ‡é’ˆç±»å‹ä¸æ˜¯æ–°ç±»å‹ï¼Œä½†å…¶å®ä»»ä½•ç±»å‹çš„æŒ‡é’ˆç±»å‹éƒ½æ˜¯ä¸€ä¸ªå…¨æ–°çš„ç±»å‹ï¼Œæ•°ç»„å’Œåˆ‡ç‰‡ä¹Ÿç±»ä¼¼ã€‚å¦‚ `[]int` å’Œ `[3]int` å°±æ˜¯ä¸¤ç§æ–°ç±»å‹ã€‚ç†è§£äº†è¿™ç‚¹ï¼Œå¯¹åº•å±‚æ•°æ®ç±»å‹çš„åˆ¤æ–­ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼‰

3. **ç±»å‹æ¨æ–­**â€”â€”ç¼–è¯‘å™¨å¯ä»¥æ¨æ–­å˜é‡æˆ–å‡½æ•°çš„ç±»å‹ï¼Œè€Œä¸éœ€è¦æ˜¾å¼å£°æ˜å®ƒã€‚Go æ‹¥æœ‰ *å•å‘ç±»å‹æ¨ç†* (*Uni-directional type inference*)ã€‚

4. **ç±»å‹å…¼å®¹**â€”â€”

   1. ä¸‹é¢å“ªä¸ªèµ‹å€¼æ˜¯è¢«ç±»å‹ç³»ç»Ÿæ‰€å…è®¸çš„ï¼Ÿ`a int; b int8; a = b; `
   2. å¦‚ä½•å®šä¹‰ä¸¤ä¸ªç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Ÿâ€”â€”åœ¨[Goçš„å¯èµ‹å€¼åˆ¤æ–­]([The Go Programming Language Specification - go.dev](https://go.dev/ref/spec#Assignability))ä¸­ä¸»è¦ç”±ç±»å‹æ˜¯å¦å¯ä»¥äº’æ¢å¼•ç”¨å†³å®šã€‚æˆ‘ä»¬ç­‰ä¼šä¼šè¯¦ç»†æ¢è®¨ã€‚

## Go è¯­è¨€çš„ç±»å‹ç³»ç»Ÿ

Go æœ‰å¾ˆå¤šåŸºç¡€çš„è§„åˆ™æ¥æ§åˆ¶ç±»å‹ç³»ç»Ÿï¼Œè¿™é‡Œæˆ‘ä»¬åªæŒ‘äº›é‡è¦çš„ä¸€èµ·æ¥çœ‹çœ‹ã€‚



ä½†æ˜¯ï¼Œåœ¨æŠ›ä¸‹ä¸€åˆ‡æ¦‚å¿µå‰ï¼Œä¸å¦‚å…ˆçœ‹çœ‹æˆ‘ç»™ä½ ä»¬å‡†å¤‡çš„å‡ ä¸ªå°ä¾‹åœ¨å­ï¼Œå®ƒè¦†ç›–äº†ä¸€äº› Go ç±»å‹ç³»ç»Ÿçš„åŸºç¡€æ¦‚å¿µã€‚æˆ‘ä¼šåœ¨è®²è§£é‡è¦æ¦‚å¿µçš„æ—¶å€™å¸¦ä½ åƒé€è¿™äº›ä¾‹å­ã€‚



å…ˆçœ‹çœ‹è¿™äº›ä»£ç ç‰‡æ®µå§ï¼Œå“ªäº›èƒ½æˆåŠŸé€šè¿‡ç¼–è¯‘ï¼Œå“ªäº›ä¸èƒ½ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

![type_system_figure1](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/type_system_figure1.png)

![type_system_figure2](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/type_system_figure2.png)

æˆ‘å¸Œæœ›ä½ èƒ½å†™ä¸‹è‡ªå·±çš„ç­”æ¡ˆå’Œç†ç”±ï¼Œè¿™æ ·åœ¨æœ€åæˆ‘ä»¬å°±èƒ½ä¸€èµ·æ¢è®¨ã€‚

## æœ‰åç±»å‹ï¼ˆNamed Typesï¼‰

ä¹Ÿå¯è¢«è¯‘ä½œ ã€Œå‘½åç±»å‹ã€ã€‚



è¯¸å¦‚`int`, `int64`, `float32`, `string` å’Œ `bool` ç­‰ç±»å‹æ˜¯é¢„å…ˆå®šä¹‰ï¼ˆpre-declareï¼‰çš„ã€‚**æ‰€æœ‰çš„é¢„å…ˆå®šä¹‰çš„å¸ƒå°”å‹ã€æ•°å­—å‹ï¼Œå­—ç¬¦ä¸²ç±»å‹éƒ½æ˜¯æœ‰åç±»å‹ã€‚**

> è¯‘è€…æ³¨ï¼š
>
> å†…ç½®å­—ç¬¦ä¸²ç±»å‹ï¼š string 
> å†…ç½®å¸ƒå°”ç±»å‹ï¼š bool 
> å†…ç½®æ•°å€¼ç±»å‹ï¼š
>
> * int8ã€uint8ï¼ˆ byteï¼‰ã€int16ã€uint16ã€int32ï¼ˆ runeï¼‰ã€uint32ã€int64ã€uint64
> * float32ã€float64
> * complex64ã€complex128



åŒæ ·çš„ï¼Œä»»ä½•é€šè¿‡ã€Œç±»å‹å£°æ˜ `type declaration`ã€åˆ›å»ºçš„æ–°ç±»å‹ï¼Œä¹Ÿæ˜¯æœ‰åç±»å‹ã€‚å¦‚ï¼š

```go
var i int // named type
type myInt int // named type
var b bool // named type
```



> è¯‘è€…æ³¨ï¼š
>
> 1. ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜¯ Go è¯­è¨€é¢„å®šä¹‰ç±»å‹
> 2. ç¬¬äºŒä¸ªç”¨äº†ç±»å‹å®šä¹‰ï¼Œç±»å‹å£°æ˜åˆ†ä¸ºã€Œç±»å‹å®šä¹‰ã€å’Œã€Œç±»å‹åˆ«åã€ä¸¤ç§ã€‚ `type myInt = int` æ˜¯ç±»å‹åˆ«åã€‚



**æœ‰åç±»å‹ä¸å®šä¹‰ç±»å‹ï¼Œä¸å…¶ä»–ç±»å‹éƒ½æ˜¯æ°¸è¿œä¸ç›¸ç­‰çš„**ã€‚

## æ— åç±»å‹ï¼ˆUnnamed Typesï¼‰

ä¹Ÿå¯è¢«è¯‘ä½œã€Œæœªå‘½åç±»å‹ã€ã€‚



**å¤åˆï¼ˆç»„åˆï¼‰ç±»å‹**â€”â€”æ•°ç»„ï¼Œç»“æ„ä½“ï¼ŒæŒ‡é’ˆï¼Œå‡½æ•°ï¼Œæ¥å£ï¼Œåˆ‡ç‰‡ï¼Œæ˜ å°„å’Œ channel â€”â€”éƒ½æ˜¯æ— åç±»å‹ã€‚

```go
[]string // unnamed type
map[string]string // unnamed type
[10]int // unnamed type
```

ä¸Šé¢çš„ã€Œç±»å‹å­—é¢é‡ã€ï¼ˆç±»å‹å­—é¢é‡æ˜¯ä¸€ä¸ªç”¨æ¥è¡¨ç¤ºæ··åˆå€¼çš„æ¦‚å¿µï¼‰ä»…ä»…æè¿°äº†å¤åˆç±»å‹æ˜¯å¦‚ä½•è¢«ç»„ç»‡çš„ï¼Œç±»å‹æœ¬èº«å¹¶æ²¡æœ‰åå­—ã€‚



## åº•å±‚ç±»å‹

æ¯ä¸ªç±»å‹ `T` éƒ½æ‹¥æœ‰åº•å±‚ç±»å‹ã€‚  



1. å¦‚æœ `T` æ˜¯é¢„å®šä¹‰çš„å¸ƒå°”ã€æ•°å­—ã€å­—ç¬¦ä¸²æˆ–ç±»å‹å­—é¢é‡ï¼Œå®ƒçš„åº•å±‚ç±»å‹å°±æ˜¯å®ƒæœ¬èº«ã€‚

2. å¦åˆ™ï¼Œ`T` çš„åº•å±‚ç±»å‹æ˜¯å…¶åœ¨ç±»å‹å£°æ˜æ—¶æ‰€å¼•ç”¨çš„ç±»å‹çš„åº•å±‚ç±»å‹ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šå³ï¼Œåœ¨ä¸€ä¸ªç±»å‹å£°æ˜ä¸­ï¼Œæ–°å£°æ˜çš„ç±»å‹å’ŒåŸç±»å‹å…±äº«åº•å±‚ç±»å‹ï¼‰

![underlying_types](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/underlying_types.png)

è®©æˆ‘ä»¬é€è¡Œåˆ†æï¼š



* 3 å’Œ 8ï¼š`string` æ˜¯åº•å±‚é¢„å®šä¹‰ç±»å‹ï¼Œæ‰€ä»¥åº•å±‚ç±»å‹æ˜¯ `string` æœ¬èº«
* 5 å’Œ 7ï¼šç±»å‹å£°æ˜æœ€å³ä¾§çš„æ˜¯ä¸¤ä¸ªã€Œç±»å‹å­—é¢é‡ã€ï¼Œæ‰€ä»¥åº•å±‚ç±»å‹åˆ†åˆ«æ˜¯ `map[string]int` å’Œ `*N` ã€‚æ³¨æ„ï¼šç±»å‹å­—é¢é‡ä¹Ÿæ˜¯æ— åç±»å‹ã€‚
* 4ã€6 ã€10ï¼šå®ƒä»¬çš„åº•å±‚ç±»å‹ä¸ç±»å‹å£°æ˜æ—¶æ‰€å¼•ç”¨çš„é‚£ä¸ªç±»å‹ç›¸åŒã€‚è¯‘è€…æ³¨ï¼š
  * 4ï¼šä¸ `A` çš„åº•å±‚ç±»å‹ç›¸åŒï¼Œå³ `B` çš„åº•å±‚ç±»å‹æ˜¯ `string`
  * 6ï¼šä¸ `M` çš„åº•å±‚ç±»å‹ç›¸åŒï¼Œå³ `N` çš„åº•å±‚ç±»å‹æ˜¯ `map[string]int`
  * 10ï¼šä¸ `T` çš„åº•å±‚ç±»å‹ç›¸åŒï¼Œå³ `U` çš„åº•å±‚ç±»å‹æ˜¯ `map[S]int`



è®©æˆ‘ä»¬å†çœ‹çœ‹ç¬¬ 9 è¡Œçš„ `type T map[S]int`ã€‚



`S` çš„åº•å±‚ç±»å‹æ˜¯ `string`ï¼Œæ‰€ä»¥ï¼Œéš¾é“ `T` çš„åº•å±‚ç±»å‹ä¸åº”è¯¥æ˜¯ `map[string]int` å—ï¼Ÿä¸ºä»€ä¹ˆæ˜¯ `map[S]int` ï¼Ÿ



å› ä¸ºæˆ‘ä»¬åœ¨è°ˆè®º `map[S]int` çš„åº•å±‚æ— åç±»å‹æ—¶ï¼Œåœ¨é‡åˆ°ç¬¬ä¸€ä¸ªæ— åç±»å‹æ—¶å°±åœæ­¢è¿½æº¯ï¼ˆè¯‘æ³¨ï¼š`map[S]int`å°±æ˜¯æˆ‘ä»¬åœ¨é€’å½’å¯»æ‰¾ `T` çš„åº•å±‚ç±»å‹æ—¶é‡åˆ°çš„ç¬¬ä¸€ä¸ªæ— åç±»å‹ï¼Œç«‹å³åœæ­¢ï¼‰ã€‚æˆ–è€…æ­£å¦‚ Go è¯­è¨€è§„èŒƒä¸Šå†™çš„ï¼Œå¦‚æœ `T` æ˜¯ç±»å‹å­—é¢é‡ï¼Œé‚£ä¹ˆå®ƒçš„ç±»å‹å°±æ˜¯å®ƒæœ¬èº«ã€‚



ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆæˆ‘è¿™ä¹ˆé‡è§†ã€Œæ— åç±»å‹ã€ã€ã€Œæœ‰åç±»å‹ï¼ˆå®šä¹‰ç±»å‹ï¼‰ã€å’Œã€Œåº•å±‚ç±»å‹ã€ã€‚å› ä¸ºå®ƒä»¬åœ¨ Go è¯­è¨€è§„èŒƒä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œä½¿å¾—æˆ‘ä»¬çš„è®¨è®ºèƒ½å¤Ÿç»§ç»­ã€‚å®ƒèƒ½å¸®åŠ©æˆ‘ä»¬ç†è§£ï¼Œä¸ºä»€ä¹ˆä¸Šé¢è´´çš„é‚£äº›ä»£ç ï¼Œæœ‰äº›é•¿å¾—å‡ ä¹ä¸€æ ·ï¼Œä½†ç”šè‡³è¿‡ä¸äº†ç¼–è¯‘ã€‚



## å¯èµ‹å€¼æ€§

å…³äºä¸€ä¸ªå€¼ `x` æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ª ç±»å‹ä¸º `T` çš„å˜é‡ï¼Œæ»¡è¶³ä»¥ä¸‹è§„åˆ™ä¹‹ä¸€å°±å¯èµ‹å€¼ï¼ˆ[è¯‘è‡ªGoè¯­è¨€å¯èµ‹å€¼æ€§è§„åˆ™]([The Go Programming Language Specification - go.dev](https://go.dev/ref/spec#Assignability))ï¼‰ï¼š

* x çš„ç±»å‹ ä¸ T ç›¸åŒã€‚

* x çš„ç±»å‹ V å’Œ ç±»å‹ T çš„åº•å±‚ç±»å‹ç›¸åŒï¼Œä¸” V å’Œ T è‡³å°‘æœ‰ä¸€ä¸ªä¸æ˜¯ ã€Œå®šä¹‰ç±»å‹ï¼ˆæœ‰åç±»å‹ï¼‰ã€ã€‚

* T  æ˜¯æ¥å£ç±»å‹ï¼Œä¸” x å®ç°äº† T æ¥å£ã€‚

* x æ˜¯åŒå‘ channel å€¼ ï¼ŒT æ˜¯ channel ç±»å‹ã€‚x çš„ç±»å‹ V å’Œ T æ‹¥æœ‰ç›¸åŒçš„å…ƒç´ ç±»å‹ï¼Œå¹¶ä¸” V å’Œ T è‡³å°‘æœ‰ä¸€ä¸ªä¸æ˜¯ã€Œå®šä¹‰ç±»å‹ã€ã€‚

  > è¯‘è€…æ³¨ï¼š `ch = make(chan int)`ï¼Œå…¶ä¸­ `int` å°±æ˜¯ã€Œå…ƒç´ ç±»å‹ã€

* x æ˜¯é¢„å®šä¹‰çš„ `nil` å€¼ï¼ŒT æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå‡½æ•°ï¼Œåˆ‡ç‰‡ï¼Œæ˜ å°„ï¼Œchannel æˆ– æ¥å£ç±»å‹ã€‚

* x çš„æ— ç±»å‹çš„å¯è¢« T ç±»å‹è¡¨ç¤ºçš„å¸¸é‡å€¼

  > è¯‘è€…æ³¨ï¼šå¦‚ï¼Œ `var num int = 1`



è™½ç„¶è¿™äº›æ¡ä»¶éƒ½æ˜¯è‡ªè§£é‡Šçš„ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸€èµ·æ¥çœ‹çœ‹å…¶ä¸­çš„ä¸€æ¡å§ã€‚



è§„åˆ™ï¼šèµ‹å€¼æ—¶ï¼Œä¸¤è¾¹çš„åº•å±‚ç±»å‹éœ€è¦ç›¸åŒï¼Œå¹¶ä¸”è‡³å°‘è¦æœ‰ä¸€ä¸ªä¸æ˜¯ã€Œæœ‰åç±»å‹ã€ã€‚

> è¯‘è€…æ³¨ï¼šä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šè§„åˆ™éƒ½å¼ºè°ƒäº†ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªä¸æ˜¯ã€Œæœ‰åç±»å‹ã€ï¼Ÿè¯»è€…å¯åœ¨çœ‹åˆ°ã€Œç±»å‹ä¸€è‡´æ€§ã€ç« èŠ‚æ—¶ç•™ä¸ªå¿ƒçœ¼ã€‚



æˆ‘ä»¬å†æ¥çœ‹çœ‹å‰æ–‡çš„ Figure 4 å’Œ Figure 5 æ‰€ç¤ºä»£ç ã€‚



```go
// Figure 5
package main

type aInt int

func main() {
	var i int = 10
	var ai aInt = 100
	i = ai
	printAiType(i)
}

func printAiType(ai aInt) {
	print(ai)
}
```

ä¸Šè¿°ä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š

```
8:4: cannot use ai (type aInt) as type int in assignment
9:13: cannot use i (type int) as type aInt in argument to printAiType
```

åŸå› ï¼š`i` æ˜¯æœ‰åç±»å‹ `int`ï¼Œ `ai` æ˜¯æœ‰åç±»å‹ `aInt`ï¼Œè™½ç„¶å®ƒä»¬çš„åº•å±‚ç±»å‹éƒ½æ˜¯ `int`ï¼Œä½†ä»ä¸èƒ½èµ‹å€¼ã€‚

```go
// Firgure 4
package main

type MyMap map[int]int

func main() {
	m := make(map[int]int)
	var mMap MyMap
	mMap = m
	printMyMapType(mMap)
	print(m)
}

func printMyMapType(mMap MyMap) {
	print(mMap)
}
```

ä»£ç ç‰‡æ®µ 4 èƒ½é€šè¿‡ç¼–è¯‘ã€‚å› ä¸º `m` æ˜¯æ— åç±»å‹ `map[int]int`ï¼Œ`mMap` çš„åº•å±‚ç±»å‹å’Œç±»å‹å£°æ˜åŸç±»å‹ `MyMap` çš„åº•å±‚ç±»å‹ç›¸åŒï¼Œéƒ½æ˜¯ `map[int]int`ï¼Œ å³ `m` å’Œ `mMap` çš„åº•å±‚ç±»å‹ç›¸åŒã€‚



## ç±»å‹è½¬æ¢

ä¸€ä¸ªé å¸¸é‡çš„å€¼ `x` èƒ½è¢«è½¬æ¢æˆç±»å‹ `T` ï¼Œå½“æ»¡è¶³ä»¥ä¸‹ä»»ä½•æ¡ä»¶ä¹‹ä¸€ï¼š[è¯‘è‡ª Go è¯­è¨€ç±»å‹è½¬æ¢è§„åˆ™]([The Go Programming Language Specification - go.dev](https://go.dev/ref/spec#Conversions))



* x å¯èµ‹å€¼ç»™ T

* å¿½ç•¥ç»“æ„ä½“ tagï¼Œ x çš„ç±»å‹å’Œ T çš„ç±»å‹æ‹¥æœ‰ç›¸åŒçš„åº•å±‚ç±»å‹ã€‚

* å¿½ç•¥ç»“æ„ä½“ tagï¼Œx çš„ç±»å‹å’Œ T éƒ½æ˜¯æ— åæŒ‡é’ˆç±»å‹ï¼Œå¹¶ä¸”ä»–ä»¬çš„æŒ‡é’ˆåŸºç±»å‹æ‹¥æœ‰ç›¸åŒçš„åº•å±‚ç±»å‹ã€‚

  > è¯‘è€…æ³¨ï¼šGo è¯­è¨€ä¸­ï¼Œæ”¹å˜ç»“æ„ä½“æˆå‘˜çš„ç›¸å¯¹ä½ç½®ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ç»“æ„ä½“ç±»å‹ã€‚

* x çš„ç±»å‹å’Œ T éƒ½æ˜¯æ•´æ•°æˆ–æµ®ç‚¹æ•°æŒ‡é’ˆç±»å‹ã€‚

* x çš„ç±»å‹å’Œ T éƒ½æ˜¯å¤æ•°ç±»å‹ï¼ˆcomplexï¼‰ã€‚

* x çš„æ˜¯æ•´æ•°åˆ‡ç‰‡æˆ–å­—èŠ‚ï¼ˆbyteï¼‰åˆ‡ç‰‡æˆ– runes åˆ‡ç‰‡ï¼ŒT æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚

* x æ˜¯å­—ç¬¦ä¸²ï¼Œ T æ˜¯ byte æˆ– runes åˆ‡ç‰‡ã€‚

* x æ˜¯åˆ‡ç‰‡ï¼ŒT æ˜¯æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œå¹¶ä¸”åˆ‡ç‰‡å’Œæ•°ç»„çš„åŸºç±»å‹æ‹¥æœ‰ç›¸åŒçš„åº•å±‚ç±»å‹ã€‚



çœ‹çœ‹ Figure 3ã€‚

```go
// figure 3
package main

type Meter int64

type Centimeter int32

func main() {
	var cm Centimeter = 1000
	var m Meter
	m = Meter(cm)
	print(m)
	cm = Centimeter(m)
	print(cm)
}
```

ä¸Šè¿°ä»£ç å¯ç¼–è¯‘é€šè¿‡ï¼Œå› ä¸º `Meter` å’Œ `Centimeter` çš„åº•å±‚ç±»å‹éƒ½æ˜¯æ•´å‹ï¼Œä¸”åº•å±‚ç±»å‹èƒ½ç›¸äº’è½¬æ¢ã€‚



åœ¨æˆ‘ä»¬çœ‹ Figure1 å’Œ Figure2 å‰ï¼Œæˆ‘ä»¬ä¸å¦¨ä¸€èµ·ç ”ç©¶ä¸‹ Go è¯­è¨€ç±»å‹ç³»ç»Ÿçš„å¦ä¸€ä¸ªæ›´ä¸ºåŸºç¡€çš„è§„èŒƒã€‚



## ç±»å‹ä¸€è‡´æ€§

**ä¸¤ç§ç±»å‹è¦ä¹ˆç›¸åŒï¼Œè¦ä¹ˆä¸åŒ**ã€‚



åœ¨é€šå¸¸çš„ç±»å‹ç³»ç»Ÿä¸­ï¼Œæœ‰ä¸¤ä¸ªæ ‡å‡†æ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªç±»å‹æ˜¯å¦å¯è§†ä¸ºåŒä¸€ç±»å‹ã€‚**åå­—ç›¸åŒ** å’Œ **ç»“æ„ç›¸åŒ**ã€‚



**åå­—ç›¸åŒ** æ˜¯éå¸¸ç›´è§‚çš„ï¼šä¸¤ä¸ªç±»å‹å½“ä¸”ä»…å½“ç±»å‹åå­—ç›¸åŒæ—¶æ‰ç›¸åŒã€‚



æ‰€ä»¥ï¼Œåœ¨ Go è¯­è¨€é‡Œé¢ï¼Œä¸€ä¸ªå·²å®šä¹‰çš„ç±»å‹ï¼ˆæœ‰åç±»å‹ï¼‰ï¼Œæ°¸è¿œå’Œå…¶ä»–ç±»å‹ä¸ç›¸åŒã€‚å› ä¸ºä¸¤ä¸ªæœ‰åç±»å‹çš„åå­—ä¸å¯èƒ½ç›¸åŒã€‚



**ç»“æ„ç›¸åŒ**ï¼šä¸¤ä¸ªç±»å‹å½“ä¸”ä»…å½“å®ƒä»¬æ‹¥æœ‰ç›¸åŒçš„ã€Œç»“æ„ï¼ˆstructureï¼‰ã€æ—¶æ‰ç›¸åŒã€‚



åœ¨ Go è¯­è¨€ä¸­ï¼Œå½“ä¸¤ä¸ªç±»å‹ç»“æ„ç›¸åŒä¸”ä¸æ˜¯æœ‰åç±»å‹æ—¶ï¼Œç±»å‹æ‰ç›¸åŒã€‚



æ‰€ä»¥ï¼Œç”šè‡³ Go è¯­è¨€ä¸­é¢„å®šä¹‰çš„ æœ‰åç±»å‹/å®šä¹‰ç±»å‹ï¼Œä¾‹å¦‚ï¼Œ`int` å’Œ `int64` ä¹Ÿä¸æ˜¯ç›¸åŒç±»å‹ã€‚å¹¶ä¸”ï¼ŒGo è¯­è¨€æ¥å£ç±»å‹çš„å¯èµ‹å€¼æ€§ä¹Ÿå–å†³äº [ç»“æ„ç±»å‹ç³»ç»Ÿï¼ˆStructural type systemï¼‰]([Structural type system - Wikipedia](https://en.wikipedia.org/wiki/Structural_type_system)) ã€‚ **Go è¯­è¨€æ²¡æœ‰ Duck Type**ã€‚



(ä¸‹é¢æ˜¯[åŸä½œè€…ä¹‰æ„¤å¡«è†ºçš„æ¨ç‰¹]([Ankur Anand åœ¨ Twitter: "There is No "Duck typing in @golang". Go uses "structural typing" on methods to determine the compatibility of a type with an interface, not "Duck Typing". I Repeat There is *NO* Duck Typing in #golang. Unfortunately, many articles on the web have got it wrong. ğŸ˜‡" / Twitter](https://twitter.com/in_aanand/status/1072476894308773888?ref_src=twsrc^tfw|twcamp^tweetembed|twterm^1072476894308773888|twgr^|twcon^s1_&ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fin_aanand%2Fstatus%2F1072476894308773888image%3Dhttps3A%2F%2Fi.embed.ly%2F1%2Fimage3Furl3Dhttps253A252F252Fpbs.twimg.com252Fprofile_images252F1097738091530342400252FFS0a8_YX_400x400.png26key3Da19fcc184b9711e1b4764040d3dc5c07))) è¯‘è€…ä¿ç•™æ„è§ã€‚

![type_system_twitter](https://bird-notes.oss-cn-hangzhou.aliyuncs.com/img/type_system_twitter.png)



ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ç»“æ„ä½“çš„è½¬æ¢ï¼š



è§„åˆ™ï¼šå¿½ç•¥ç»“æ„ä½“ tagï¼Œx çš„ç±»å‹å’Œ T æ‹¥æœ‰ç›¸åŒçš„åº•å±‚ç±»å‹ã€‚



```go
// figure 2
package main

type Meter struct {
	value int64
}

type Centimeter struct {
	value int32
}

func main() {
	cm := Centimeter{
		value: 1000,
	}

	var m Meter
	m = Meter(cm)
	print(m.value)
	cm = Centimeter(m)
	print(cm.value)
}
```

æ³¨æ„è§„åˆ™ï¼š**ç›¸åŒçš„åº•å±‚ç±»å‹**ã€‚  

å› ä¸ºç»“æ„ä½“åŸŸ `Meter.Value` çš„åº•å±‚ç±»å‹æ˜¯ `int64`ï¼Œ è€Œ `Centimeter.Value` çš„åº•å±‚ç±»å‹æ˜¯ `int32`ï¼Œå®ƒä»¬ä¸æ˜¯åŒä¸€ç±»å‹ï¼Œå› ä¸ºã€Œæœ‰åç±»å‹ï¼ˆå®šä¹‰ç±»å‹ï¼‰ã€æ°¸è¿œä¸å…¶ä»–ç±»å‹ä¸åŒã€‚



å†æ¥çœ‹çœ‹ä»£ç æ®µ 1

```go
// figure 1
package main

type Meter struct {
	value int64
}

type Centimeter struct {
	value int64
}

func main() {
	cm := Centimeter{
		value: 1000,
	}

	var m Meter
	m = Meter(cm)
	print(m.value)
	cm = Centimeter(m)
	print(cm.value)
}
```

 `Meter.Value` çš„åº•å±‚ç±»å‹å’Œ `Centimeter.Value` çš„åº•å±‚ç±»å‹éƒ½æ˜¯ `int64`ï¼Œæ‰€ä»¥ç±»å‹è½¬æ¢èƒ½é€šè¿‡ç¼–è¯‘ã€‚



åŸä½œè€…ï¼šæˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½åœ¨ Go å‹ç³»ç»Ÿä¸Šä¸ºæ‚¨æä¾›ä¸€äº›æ–°çš„è§è§£ï¼Œè€Œæˆ‘åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ä¹Ÿè·å¾—äº†æ–°çš„æ´è§ã€‚



> è¯‘è€…ï¼šä¿ºä¹Ÿä¸€æ ·ï¼ç¿»è¯‘ä¸€éå’Œç®€å•è¯»ä¸€éæ”¶è·å®Œå…¨ä¸ä¸€æ ·ã€‚



## å‚è€ƒæ–‡çŒ®

1. åŸæ–‡ï¼ˆéœ€ç§‘å­¦ä¸Šç½‘ï¼‰ï¼š[A closer look at Golang type system | by Ankur Anand | Medium](https://medium.com/@ankur_anand/a-closer-look-at-go-golang-type-system-3058a51d1615)
2. [golang101â€”â€”ç¬¬14ç«  go ç±»å‹ç³»ç»Ÿæ¦‚è¿°](https://github.com/golang101/golang101)